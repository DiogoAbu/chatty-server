# -----------------------------------------------
# !!! THIS FILE WAS GENERATED BY TYPE-GRAPHQL !!!
# !!!   DO NOT MODIFY THIS FILE BY YOURSELF   !!!
# -----------------------------------------------

input ChangePasswordInput {
  code: Float
  password: String
}

input CreateAccountInput {
  email: String
  name: String
  password: String
  pictureUri: String
}

input CreateMessageInput {
  cipher: String
  messageId: String
  roomId: ID
  type: MessageType
}

input CreateRoomInput {
  id: ID
  name: String
  pictureUri: String
  recipientsId: [ID]
}

type Device {
  createdAt: Timestamp
  id: ID
  name: String
  platform: DevicePlatform
  token: String
  user: User
}

"""The acceptable platforms"""
enum DevicePlatform {
  android
  ios
  macos
  web
  windows
}

input ForgotPasswordInput {
  email: String
}

type GetMessagesResponse {
  cursor: Timestamp
  hasMore: Boolean
  items: [Message]
}

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSON @specifiedBy(url: "http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf")

input ListUsersOrder {
  email: String
  name: String
}

input ListUsersWhere {
  email: String
  name: String
}

type Message {
  cipher: String
  createdAt: Timestamp
  id: ID
  readReceipts: [ReadReceipt]
  room: Room
  sender: User
  sentAt: Timestamp
  type: MessageType
  updatedAt: Timestamp
}

"""The message types"""
enum MessageType {
  announcement
  default
  sharedKey
}

type Mutation {
  """
  Find the user related to the one-time-password, check its validity, and update the password.
  """
  changePassword(data: ChangePasswordInput): Boolean
  createAccount(data: CreateAccountInput): SignInResponse
  createMessage(data: CreateMessageInput): Message
  createRoom(data: CreateRoomInput): Room

  """
  Find the user, store an one-time-password, and send it to the user`s email.
  """
  forgotPassword(data: ForgotPasswordInput): Boolean
  pushChanges(
    changes: JSON

    """Last time client pulled changes in milliseconds since UNIX epoch"""
    lastPulledAt: Float
  ): Boolean
  registerDevice(data: RegisterDeviceInput): Boolean
  signIn(data: SignInInput): SignInResponse

  """Add signed user as follower"""
  startFollowing(userId: String!): Boolean

  """Remove signed user as follower"""
  stopFollowing(userId: String!): Boolean
  unregisterDevice(data: RegisterDeviceInput): Boolean
}

type PullChangesResult {
  changes: JSON

  """Last successful pull in milliseconds since UNIX epoch"""
  timestamp: Float!
}

type Query {
  getMessages(afterDate: Timestamp, limit: Int = 10, roomId: ID): GetMessagesResponse
  getRooms: [Room]
  listUsers(order: ListUsersOrder, skip: Int = 0, take: Int = 10, where: ListUsersWhere): [User]
  me: User
  pullChanges(
    """Last time client pulled changes in milliseconds since UNIX epoch"""
    lastPulledAt: Float
  ): PullChangesResult
}

type ReadReceipt {
  id: ID
  message: Message
  receivedAt: Float
  room: Room
  seenAt: Float
  updatedAt: Timestamp
  user: User
}

input RegisterDeviceInput {
  name: String
  platform: DevicePlatform
  token: String
}

type Room {
  createdAt: Timestamp
  id: ID
  lastMessage: Message
  members: [User]
  messages: [Message]
  name: String
  pictureUri: String
  readReceipts: [ReadReceipt]
  updatedAt: Timestamp
}

input SignInInput {
  email: String
  password: String
}

type SignInResponse {
  token: String
  user: User
}

type Subscription {
  shouldSync(roomIds: [ID]): Boolean
}

"""
The javascript `Date` as integer. Type represents date and time as number of milliseconds from start of UNIX epoch.
"""
scalar Timestamp

type User {
  createdAt: Timestamp
  derivedSalt: String
  devices: [Device]
  email: String
  id: ID
  isFollowedByMe: Boolean
  isFollowingMe: Boolean
  lastAccessAt: Timestamp
  messages: [Message]
  name: String
  pictureUri: String
  publicKey: String
  role: String
  rooms: [Room]
  updatedAt: Timestamp
}
