# -----------------------------------------------
# !!! THIS FILE WAS GENERATED BY TYPE-GRAPHQL !!!
# !!!   DO NOT MODIFY THIS FILE BY YOURSELF   !!!
# -----------------------------------------------

input ChangePasswordInput {
  code: Float
  password: String
}

input CreateAccountInput {
  email: String
  name: String
  password: String
  pictureUri: String
}

input CreateMessageInput {
  cipher: String
  messageId: String
  roomId: ID
  type: MessageType
}

input CreateRoomInput {
  id: ID
  name: String
  pictureUri: String
  recipientsId: [ID]
}

type Device {
  createdAt: Timestamp
  id: ID
  name: String
  platform: DevicePlatform
  token: String
  user: User
}

"""The acceptable platforms"""
enum DevicePlatform {
  android
  ios
  macos
  web
  windows
}

input ForgotPasswordInput {
  email: String
}

type GetMessagesResponse {
  cursor: Timestamp
  hasMore: Boolean
  items: [Message]
}

input ListUsersOrder {
  email: String
  name: String
}

input ListUsersWhere {
  email: String
  name: String
}

type Message {
  cipher: String
  createdAt: Timestamp
  id: ID
  readReceipts: [ReadReceipt]
  room: Room
  sender: User
  sentAt: Timestamp
  type: MessageType
  updatedAt: Timestamp
}

type MessageChanges {
  _changed: String
  _status: String
  cipher: String
  createdAt: Float
  id: ID
  roomId: ID
  sentAt: Float
  type: MessageType
  userId: ID
}

input MessageChangesInput {
  _changed: String
  _status: String
  cipher: String
  createdAt: Float
  id: ID
  roomId: ID
  sentAt: Float
  type: MessageType
  userId: ID
}

type MessageTableChangeSet {
  created: [MessageChanges]
  deleted: [ID]
  updated: [MessageChanges]
}

input MessageTableChangeSetInput {
  created: [MessageChangesInput]
  deleted: [ID]
  updated: [MessageChangesInput]
}

"""The message types"""
enum MessageType {
  announcement
  default
  sharedKey
}

type Mutation {
  """
  Find the user related to the one-time-password, check its validity, and update the password.
  """
  changePassword(data: ChangePasswordInput): Boolean
  createAccount(data: CreateAccountInput): SignInResponse
  createMessage(data: CreateMessageInput): Message
  createRoom(data: CreateRoomInput): Room

  """
  Find the user, store an one-time-password, and send it to the user`s email.
  """
  forgotPassword(data: ForgotPasswordInput): Boolean
  pushChanges(
    changes: SyncChangesInput

    """Last time client pulled changes in milliseconds since UNIX epoch"""
    lastPulledAt: Float
  ): Boolean
  registerDevice(data: RegisterDeviceInput): Boolean
  signIn(data: SignInInput): SignInResponse

  """Add signed user as follower"""
  startFollowing(userId: String!): Boolean

  """Remove signed user as follower"""
  stopFollowing(userId: String!): Boolean
  unregisterDevices(data: UnregisterDevicesInput): Boolean
}

type PullChangesResult {
  changes: SyncChanges

  """Last successful pull in milliseconds since UNIX epoch"""
  timestamp: Float!
}

type Query {
  getMessages(afterDate: Timestamp, limit: Int = 10, roomId: ID): GetMessagesResponse
  getRooms: [Room]
  listUsers(order: ListUsersOrder, skip: Int = 0, take: Int = 10, where: ListUsersWhere): [User]
  me: User
  pullChanges(
    """Last time client pulled changes in milliseconds since UNIX epoch"""
    lastPulledAt: Float
  ): PullChangesResult
}

type ReadReceipt {
  id: ID
  message: Message
  receivedAt: Float
  room: Room
  seenAt: Float
  updatedAt: Timestamp
  user: User
}

type ReadReceiptChanges {
  _changed: String
  _status: String
  id: ID
  messageId: ID
  receivedAt: Float
  roomId: ID
  seenAt: Float
  userId: ID
}

input ReadReceiptChangesInput {
  _changed: String
  _status: String
  id: ID
  messageId: ID
  receivedAt: Float
  roomId: ID
  seenAt: Float
  userId: ID
}

type ReadReceiptTableChangeSet {
  created: [ReadReceiptChanges]
  deleted: [ID]
  updated: [ReadReceiptChanges]
}

input ReadReceiptTableChangeSetInput {
  created: [ReadReceiptChangesInput]
  deleted: [ID]
  updated: [ReadReceiptChangesInput]
}

input RegisterDeviceInput {
  name: String!
  platform: DevicePlatform!
  token: String!
}

type Room {
  createdAt: Timestamp
  id: ID
  lastMessage: Message
  members: [User]
  messages: [Message]
  name: String
  pictureUri: String
  readReceipts: [ReadReceipt]
  roomPreferences: [RoomPreferences]
  updatedAt: Timestamp
}

type RoomChanges {
  _changed: String
  _status: String
  createdAt: Float
  id: ID
  isMuted: Boolean
  lastChangeAt: Float
  lastMessageId: ID
  lastReadAt: Float
  mutedUntil: Float
  name: String
  pictureUri: String
  shouldStillNotify: Boolean
}

input RoomChangesInput {
  _changed: String
  _status: String
  createdAt: Float
  id: ID
  isMuted: Boolean
  lastChangeAt: Float
  lastMessageId: ID
  lastReadAt: Float
  mutedUntil: Float
  name: String
  pictureUri: String
  shouldStillNotify: Boolean
}

type RoomMemberChanges {
  _changed: String
  _status: String

  """Not a normal uuid"""
  id: String
  roomId: ID
  userId: ID
}

input RoomMemberChangesInput {
  _changed: String
  _status: String

  """Not a normal uuid"""
  id: String
  roomId: ID
  userId: ID
}

type RoomMemberTableChangeSet {
  created: [RoomMemberChanges]
  deleted: [ID]
  updated: [RoomMemberChanges]
}

input RoomMemberTableChangeSetInput {
  created: [RoomMemberChangesInput]
  deleted: [ID]
  updated: [RoomMemberChangesInput]
}

type RoomPreferences {
  id: ID
  isMuted: Boolean
  mutedUntil: Float
  room: Room
  shouldStillNotify: Boolean
  user: User
}

type RoomTableChangeSet {
  created: [RoomChanges]
  deleted: [ID]
  updated: [RoomChanges]
}

input RoomTableChangeSetInput {
  created: [RoomChangesInput]
  deleted: [ID]
  updated: [RoomChangesInput]
}

input SignInInput {
  email: String
  password: String
}

type SignInResponse {
  token: String
  user: User
}

type Subscription {
  shouldSync(roomIds: [ID]): Boolean
}

type SyncChanges {
  messages: MessageTableChangeSet
  readReceipts: ReadReceiptTableChangeSet
  roomMembers: RoomMemberTableChangeSet
  rooms: RoomTableChangeSet
  users: UserTableChangeSet
}

input SyncChangesInput {
  messages: MessageTableChangeSetInput
  readReceipts: ReadReceiptTableChangeSetInput
  roomMembers: RoomMemberTableChangeSetInput
  rooms: RoomTableChangeSetInput
  users: UserTableChangeSetInput
}

"""
The javascript `Date` as integer. Type represents date and time as number of milliseconds from start of UNIX epoch.
"""
scalar Timestamp

input UnregisterDevicesInput {
  tokens: [String!]!
}

type User {
  createdAt: Timestamp
  derivedSalt: String
  devices: [Device]
  email: String
  id: ID
  isFollowedByMe: Boolean
  isFollowingMe: Boolean
  lastAccessAt: Timestamp
  messages: [Message]
  name: String
  pictureUri: String
  publicKey: String
  role: String
  roomPreferences: [RoomPreferences]
  rooms: [Room]
  updatedAt: Timestamp
}

type UserChanges {
  _changed: String
  _status: String
  derivedSalt: String
  email: String
  id: ID
  isFollowedByMe: Boolean
  isFollowingMe: Boolean
  name: String
  pictureUri: String
  publicKey: String
  role: String
}

input UserChangesInput {
  _changed: String
  _status: String
  derivedSalt: String
  email: String
  id: ID
  isFollowedByMe: Boolean
  isFollowingMe: Boolean
  name: String
  pictureUri: String
  publicKey: String
  role: String
}

type UserTableChangeSet {
  created: [UserChanges]
  deleted: [ID]
  updated: [UserChanges]
}

input UserTableChangeSetInput {
  created: [UserChangesInput]
  deleted: [ID]
  updated: [UserChangesInput]
}
